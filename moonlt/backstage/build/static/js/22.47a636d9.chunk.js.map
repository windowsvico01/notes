{"version":3,"sources":["containers/Pages/Plugins/Editor/Edit/index.js","containers/Pages/Plugins/Editor/action.js","containers/Pages/Plugins/Editor/reselector.js","components/Editor/index.js"],"names":["Edit","props","_this","Object","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","this","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__","call","handleChangeContent","content","contentChange","setCurrentEditor","editor","setState","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","state","txt","html","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","_components_Style__WEBPACK_IMPORTED_MODULE_14__","antd__WEBPACK_IMPORTED_MODULE_7__","onBack","window","history","back","title","subTitle","href","target","react_router_dom__WEBPACK_IMPORTED_MODULE_10__","to","style","marginLeft","_components_Editor__WEBPACK_IMPORTED_MODULE_13__","Component","connect","selectContent","dispatch","bindActionCreators","__webpack_require__","r","__webpack_exports__","d","CONTENT_CHANGE","type","reselect__WEBPACK_IMPORTED_MODULE_0__","createSelector","get","subState","ToolDef","styled","div","_templateObject","ToolCus","_templateObject2","_templateObject3","ToolBtn","_templateObject4","Editor","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","_super","wEditor","editorContent","imgUploading","_this2","elem","refs","editorElem","toolElem","toolDefElem","E","customConfig","menus","onchange","onChange","create","defaultValue","name","action","location","hostname","showUploadList","info","file","status","message","success","concat","append","response","error","id","ref","antd__WEBPACK_IMPORTED_MODULE_9__","antd__WEBPACK_IMPORTED_MODULE_10__","size","_ant_design_icons__WEBPACK_IMPORTED_MODULE_11__","React","PureComponent"],"mappings":"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","file":"static/js/22.47a636d9.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport { PageHeader, Divider } from 'antd';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { Link } from 'react-router-dom';\nimport { contentChange } from '../action';\nimport { selectContent } from '../reselector';\nimport WangEditor from '@/components/Editor';\nimport { Wrapper } from '@/components/Style';\n\n\nclass Edit extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      editor: '',\n    } \n  }\n  handleChangeContent = (content) => {\n    this.props.contentChange(content);\n  }\n  setCurrentEditor = (editor) => {\n    this.setState({\n      ...this.state,\n      editor,\n    })\n  }\n  render() {\n    const { content } = this.props;\n    if (content && this.state.editor) this.state.editor.txt.html(content);\n    return (\n      <Wrapper>\n        <PageHeader\n          onBack={() => window.history.back()}\n          title=\"富文本编辑器\"\n          subTitle={(\n            <div>\n              <a href=\"http://www.wangeditor.com/index.html\" target=\"_black\">wangeditor</a>\n              <Link to=\"/plugins/editor/preview\" style={{ marginLeft: '20px' }}> 预览 </Link>\n            </div>\n          )}\n        />\n        <WangEditor\n          setCurrentEditor={this.setCurrentEditor}\n          handleChangeContent={this.handleChangeContent}\n        />\n      </Wrapper>\n    )\n  }\n}\nconst mapStateToProps = (state) => {\n  return {\n    content: selectContent(state),\n    // hi: selectHi(state),\n    // count: selectCount(state),\n  };\n}\nconst mapActionsToProps = (dispatch) => bindActionCreators({ ...{contentChange} }, dispatch);\nexport default connect(mapStateToProps, mapActionsToProps)(Edit);","export const CONTENT_CHANGE = '/Plugins/Editor/NUM_COUNT';\n\nexport function contentChange(content) {\n    return {\n      type: CONTENT_CHANGE,\n      content,\n    };\n  }\n","import { createSelector } from 'reselect';\n// state.get 是异步的\nconst selectEditorDomain = state => state.get('Plugins/Editor');\nconst selectContent = createSelector(\n    selectEditorDomain,\n  (subState) => subState && subState.content,\n)\n\nexport {\n  selectContent\n}","import React from 'react';\nimport E from 'wangeditor';\nimport { Button, Modal, Form, Input, Upload, message, Spin } from 'antd';\nimport { LeftOutlined, UploadOutlined, PlusOutlined, PictureOutlined } from '@ant-design/icons';\nimport styled from 'styled-components';\n\nconst ToolDef = styled.div`\n  border: 1px solid #ccc;\n  border-bottom: none;\n`;\nconst ToolCus = styled.div`\n  height: 30px;\n  padding: 0 5px;\n  border-right: 1px solid #ccc;\n  border-left: 1px solid #ccc;\n`;\nconst Edit = styled.div`\n  border: 1px solid #ccc;\n  height: 300px;\n  overflow: scroll;\n`;\nconst ToolBtn = styled.div`\n  padding: 5px 10px;\n  cursor: pointer;\n  color: #999;\n  line-height: 14px;\n  font-weight: 500;\n  :hover {\n    color: #000;\n  }\n`;\nclass Editor extends React.PureComponent {\n    constructor(props){\n        super(props);\n        this.wEditor = {};\n        this.state = {\n            editorContent: '',\n            imgUploading: false,\n        };\n    }\n    componentDidMount() {\n        const elem = this.refs.editorElem;\n        const toolElem = this.refs.toolDefElem;\n        this.wEditor = new E(toolElem, elem);\n        // 配置工具栏\n        this.wEditor.customConfig.menus = [\n          'head',  // 标题\n          'bold',  // 粗体\n          'fontSize',  // 字号\n          'fontName',  // 字体\n          'italic',  // 斜体\n          'underline',  // 下划线\n          'strikeThrough',  // 删除线\n          'foreColor',  // 文字颜色\n          'backColor',  // 背景颜色\n          'link',  // 插入链接\n          'list',  // 列表\n          'justify',  // 对齐方式\n          'quote',  // 引用\n          // 'emoticon',  // 表情\n          // 'image',  // 插入图片\n          'table',  // 表格\n          // 'video',  // 插入视频\n          'code',  // 插入代码\n          'undo',  // 撤销\n          'redo'  // 重复\n        ];\n        // 使用 onchange 函数监听内容的变化，并实时更新到 state 中\n        this.wEditor.customConfig.onchange = html => {\n            this.setState({\n              editorContent: html\n            })\n            if (this.props.onChange) this.props.onChange(html);\n        }\n        this.wEditor.create()\n        this.wEditor.txt.html(this.props.defaultValue || '');\n    }\n    render() {\n      const _this = this;\n      const props = {\n        name: 'file',\n        action: window.location.hostname === '127.0.0.1' ? 'http://127.0.0.1:3000/user/fileUpload' : 'http://62.234.73.102:3000/user/fileUpload',\n        showUploadList: false,\n        onChange(info) {\n          _this.setState({\n            imgUploading: true\n          });\n          if (info.file.status === 'done') {\n            message.success(`${info.file.name} 上传成功`);\n            _this.setState({\n              imgUploading: false\n            });\n            _this.wEditor.txt.append(`<p><img src='${info.file.response.location}' /></p>`)\n          } else if (info.file.status === 'error') {\n            message.error(`${info.file.name} 上传失败`);\n            _this.setState({\n              imgUploading: false\n            });\n          }\n        },\n      };\n      return (\n        <div>\n          <ToolDef id=\"toolDef\" ref=\"toolDefElem\"></ToolDef>\n          <ToolCus id=\"toolCus\">\n          <Upload {...props}>\n            <ToolBtn>\n              {this.state.imgUploading ? <Spin size=\"small\" /> : <PictureOutlined />}\n            </ToolBtn>\n          </Upload>\n          </ToolCus>\n          <Edit ref=\"editorElem\"></Edit>\n        </div>\n      );\n    }\n}\n\nexport default Editor;"],"sourceRoot":""}
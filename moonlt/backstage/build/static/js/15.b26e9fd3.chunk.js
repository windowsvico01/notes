(window.webpackJsonp=window.webpackJsonp||[]).push([[15,69,70],{109:function(e,t,n){"use strict";n.r(t);var a=n(18),r=n(24),i=n(36),o=n(26),c=n(19),l=n(25),u=n(0),d=n.n(u),s=n(39),f=n(27),g=n(45),C=n(79),p=n(633),m=n(636),y=n(634),E=n(638),h=n(149),b=n(242),O=n(258),A=n(408),v=function(e){console.log(e);var t=[];return e.forEach(function(e){0===e.pid&&t.push(e)}),function t(n){var a=n;return n.forEach(function(n,r){var i=[];e.forEach(function(e){n.cid===e.pid&&i.push(e)}),i.length&&(t(i),a[r].children=i)}),a}(t)},j=function(e){var t="\u6dfb\u52a0\u7c7b\u76ee";return e&&e.length&&e.forEach(function(e){e.name&&"pid"===e.name[0]&&e.value&&(t="\u6dfb\u52a0\u5b50\u7c7b\u76ee")}),t},D=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleUpdateCategory=function(){var e=n.props.editCid;e?n.state.formRef.current.validateFields().then(function(t){var a={cid:e};Object.keys(t).forEach(function(e){a[e]=t[e]}),n.props.updateCategory(a)}):n.state.formRef.current.validateFields().then(function(e){var t={};Object.keys(e).forEach(function(n){t[n]=e[n]}),n.props.addCategory(t)})},n.toggleModalVisible=function(e){e||(n.state.formRef.current.resetFields(),n.props.fieldsChange([])),n.props.modalVisibleToggle(e)},n.handleFilesChange=function(e){n.state.timer&&clearTimeout(n.state.timer);var t=setTimeout(function(){n.props.fieldsChange(e),n.setState({timer:""})},200);n.setState({timer:t})},n.handleEditCategory=function(e){var t=[];Object.keys(e).forEach(function(n){"cid"!==n&&t.push({name:[n],value:e[n]})}),n.props.fieldsChange(t,e.cid),n.toggleModalVisible(!0)},n.handleAddChildCategory=function(e){var t=[{name:["pid"],value:e}];n.props.fieldsChange(t),n.toggleModalVisible(!0)},n.state={formRef:d.a.createRef(),timer:"",editId:""},n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.props.loadCategory()}},{key:"render",value:function(){var e=this,t=this.props,n=t.category,a=t.fields,r=t.modalVisible,i=this.state.formRef,o=i&&i.current&&i.current.getFieldValue("label")||"",c=[{title:"\u7c7b\u76ee\u540d\u79f0",dataIndex:"name",key:"name",width:400},{title:"cid",dataIndex:"cid",key:"cid"},{title:"\u64cd\u4f5c",key:"operate",render:function(t,n){return d.a.createElement(h.b,null,d.a.createElement(C.a,{type:"link",onClick:function(){return e.handleEditCategory(n)}},"\u7f16\u8f91"),d.a.createElement(g.b,{to:"/manage/category/detail/".concat(n.cid),style:{padding:"4px 15px"}},"\u8be6\u60c5"),1*n.pid===0&&d.a.createElement(C.a,{type:"link",onClick:function(){return e.handleAddChildCategory(n.cid)}},"\u6dfb\u52a0\u5b50\u7c7b\u76ee"))}}],l={labelCol:{span:6},wrapperCol:{span:16}};return d.a.createElement("div",null,d.a.createElement(h.f,null,d.a.createElement("div",{className:"borderLeft"}),d.a.createElement("h2",null,"\u7c7b\u76ee\u7ba1\u7406"),d.a.createElement(C.a,{type:"primary",className:"btn-r",onClick:function(){return e.toggleModalVisible(!0)}},"\u6dfb\u52a0\u7c7b\u76ee")),d.a.createElement(h.g,null,d.a.createElement(p.a,{columns:c,size:"middle",dataSource:n&&!!n.length&&v(n),pagination:!1,rowKey:"cid"})),d.a.createElement(m.a,{title:this.props.editCid?"\u7f16\u8f91\u7c7b\u76ee":j(a),visible:r,width:500,onOk:function(){return e.handleUpdateCategory()},onCancel:function(){return e.toggleModalVisible(!1)},okText:this.props.editCid?"\u786e\u5b9a":"\u6dfb\u52a0",cancelText:"\u53d6\u6d88",maskClosable:!1,forceRender:!0},d.a.createElement(y.a,{ref:i,onFieldsChange:function(t,n){return e.handleFilesChange(n)},fields:a&&a.length?a:[],initialValues:[]},d.a.createElement(y.a.Item,Object.assign({},l,{label:"\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7c7b\u76ee\u540d\u79f0"}]}),d.a.createElement(E.a,{addonAfter:d.a.createElement("div",{style:{width:"50px"}},Object(A.a)(o),"\u4e2a\u5b57")})),d.a.createElement(y.a.Item,Object.assign({},l,{label:"key",name:"path_key",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u552f\u4e00key\u503c"}]}),d.a.createElement(E.a,null)),d.a.createElement(y.a.Item,Object.assign({},l,{label:"pid",name:"pid",style:{display:"none"}}),d.a.createElement(E.a,null)))))}}]),t}(u.Component);t.default=Object(s.connect)(function(e){return{category:Object(O.selectCategory)(e),fields:Object(O.selectFields)(e),modalVisible:Object(O.selectModalVisible)(e),editCid:Object(O.selectEditCid)(e)}},function(e){return Object(f.bindActionCreators)(Object(a.a)({},b),e)})(D)},242:function(e,t,n){"use strict";n.r(t),n.d(t,"ADD_CATEGORY",function(){return a}),n.d(t,"ADD_CATEGORY_SUCCESS",function(){return r}),n.d(t,"LOAD_CATEGORY",function(){return i}),n.d(t,"LOAD_CATEGORY_SUCCESS",function(){return o}),n.d(t,"ADD",function(){return c}),n.d(t,"FIELDS_CHANGE",function(){return l}),n.d(t,"MODAL_VISIBLE_TOGGLE",function(){return u}),n.d(t,"UPDATE_CATEGORY",function(){return d}),n.d(t,"add",function(){return s}),n.d(t,"addCategory",function(){return f}),n.d(t,"addCategorySuccess",function(){return g}),n.d(t,"loadCategory",function(){return C}),n.d(t,"loadCategorySuccess",function(){return p}),n.d(t,"fieldsChange",function(){return m}),n.d(t,"modalVisibleToggle",function(){return y}),n.d(t,"updateCategory",function(){return E});var a="/Manage/Category/List/ADD_CATEGORY",r="/Manage/Category/List/ADD_CATEGORY_SUCCESS",i="/Manage/Category/List/LOAD_CATEGORY",o="/Manage/Category/List/LOAD_CATEGORY_SUCCESS",c="/Manage/Category/List/ADD",l="/Manage/Category/List/FIELDS_CHANGE",u="/Manage/Category/List/MODAL_VISIBLE_TOGGLE",d="/Manage/Category/List/UPDATE_CATEGORY";function s(e){return{type:c,params:e}}function f(e){return{type:a,params:e}}function g(e){return{type:r,data:e}}function C(e){return{type:i}}function p(e){return{type:o,data:e}}function m(e,t){return{type:l,fields:e,editCid:t}}function y(e,t){return{type:u,bool:e,editCid:t}}function E(e){return{type:d,params:e}}},258:function(e,t,n){"use strict";n.r(t),n.d(t,"selectCategory",function(){return i}),n.d(t,"selectFields",function(){return o}),n.d(t,"selectModalVisible",function(){return c}),n.d(t,"selectEditCid",function(){return l});var a=n(47),r=function(e){return e.get("Manage/Category/List")},i=Object(a.a)(r,function(e){return e&&e.category}),o=Object(a.a)(r,function(e){return e&&e.fields}),c=Object(a.a)(r,function(e){return e&&e.modalVisible}),l=Object(a.a)(r,function(e){return e&&e.editCid})},408:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return r});var a=function(e){var t=0,n=/[\u4e00-\u9fa5]/;if(e)for(var a=0,r=e.length;a<r;a+=1)if(n.test(e[a]))t+=1;else{var i=+e.charCodeAt(a);t+=i<256?.5:65377<=i&&i<=65439?.5:65512<=i&&i<=65518?.5:1}return t},r=function(e){return!(!/^\d+(\.\d+)?$/.test(e)&&!/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/.test(e))}}}]);
//# sourceMappingURL=15.b26e9fd3.chunk.js.map
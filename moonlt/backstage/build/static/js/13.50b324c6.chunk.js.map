{"version":3,"sources":["containers/Pages/Draft/Add/actions.js","containers/Pages/Draft/Add/selectors.js","utils/tools.js","components/Editor/index.js","containers/Pages/Draft/Add/index.js"],"names":["__webpack_require__","r","__webpack_exports__","d","LOAD_CATEGORY","LOAD_CATEGORY_SUCCESS","LOAD_PLATE","LOAD_PLATE_SUCCESS","FIELDS_CHANGE","PUBLISH_DRAFT","loadCategory","loadCategorySuccess","loadPlate","loadPlateSuccess","fieldsChange","publishDraft","params","type","data","fields","selectCategoryList","selectPlateList","selectFields","reselect__WEBPACK_IMPORTED_MODULE_0__","selectAddDomain","state","get","createSelector","subState","plateList","categoryList","countNum","isNumber","str","count","re","i","len","length","test","c","charCodeAt","ToolDef","styled","div","_templateObject","ToolCus","_templateObject2","Edit","_templateObject3","ToolBtn","_templateObject4","Editor","props","_this","Object","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","_super","call","wEditor","editorContent","imgUploading","_this2","elem","refs","editorElem","toolElem","toolDefElem","E","customConfig","menus","onchange","html","setState","onChange","create","txt","defaultValue","name","action","window","location","hostname","showUploadList","info","file","status","message","success","concat","append","response","error","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","id","ref","antd__WEBPACK_IMPORTED_MODULE_9__","antd__WEBPACK_IMPORTED_MODULE_10__","size","_ant_design_icons__WEBPACK_IMPORTED_MODULE_11__","React","PureComponent","TabPane","Tabs","TextArea","Input","Option","Select","ButtonCon","transCategoryData","finalData","forEach","item","pid","title","value","cid","key","push","findChild","arr","finalChild","pNode","index","tChild","cNode","children","Add","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","handleLoadPlate","formRef","current","setFieldsValue","plate","handleFilesChange","values","timer","clearTimeout","tTimer","setTimeout","handlePublish","publishing","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__","validateFields","then","keys","join","cover","getImageList","e","imageList","fileList","Array","isArray","tUrl","code","createRef","_this3","_this$props","layout","labelCol","span","wrapperCol","layoutRight","operations","react__WEBPACK_IMPORTED_MODULE_8___default","antd__WEBPACK_IMPORTED_MODULE_14__","onClick","console","log","uploadProps","className","listType","_components_Style__WEBPACK_IMPORTED_MODULE_21__","style","float","icon","_ant_design_icons__WEBPACK_IMPORTED_MODULE_19__","history","goBack","minWidth","antd__WEBPACK_IMPORTED_MODULE_11__","defaultActiveKey","tabBarExtraContent","tab","antd__WEBPACK_IMPORTED_MODULE_16__","onFieldsChange","_","all","initialValues","Item","assign","label","required","antd__WEBPACK_IMPORTED_MODULE_17__","dropdownStyle","maxHeight","overflow","treeData","placeholder","treeDefaultExpandAll","antd__WEBPACK_IMPORTED_MODULE_13__","mode","map","antd__WEBPACK_IMPORTED_MODULE_12__","rows","_components_Editor__WEBPACK_IMPORTED_MODULE_26__","getValueFromEvent","antd__WEBPACK_IMPORTED_MODULE_18__","_ant_design_icons__WEBPACK_IMPORTED_MODULE_20__","Component","connect","dispatch","bindActionCreators","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__","actions"],"mappings":"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","file":"static/js/13.50b324c6.chunk.js","sourcesContent":["export const LOAD_CATEGORY = '/Draft/Add/LOAD_CATEGORY';\nexport const LOAD_CATEGORY_SUCCESS = '/Draft/Add/LOAD_CATEGORY_SUCCESS';\n\nexport const LOAD_PLATE = '/Draft/Add/LOAD_PLATE';\nexport const LOAD_PLATE_SUCCESS = '/Draft/Add/LOAD_PLATE_SUCCESS';\n\nexport const FIELDS_CHANGE = '/Draft/Add/FIELDS_CHANGE';\n\nexport const PUBLISH_DRAFT = '/Draft/Add/PUBLISH_DRAFT';\n\nexport function loadCategory(params) {\n  return {\n    type: LOAD_CATEGORY,\n  };\n}\n\nexport function loadCategorySuccess(data) {\n  return {\n    type: LOAD_CATEGORY_SUCCESS,\n    data,\n  };\n}\n\nexport function loadPlate(params) {\n  return {\n    type: LOAD_PLATE,\n    params,\n  };\n}\n\nexport function loadPlateSuccess(data) {\n  return {\n    type: LOAD_PLATE_SUCCESS,\n    data,\n  };\n}\n\nexport function fieldsChange(fields) {\n  return {\n    type: FIELDS_CHANGE,\n    fields,\n  }\n}\n\nexport function publishDraft(params) {\n  return {\n    type: PUBLISH_DRAFT,\n    params,\n  }\n}","import { createSelector } from 'reselect';\n// state.get 是异步的\nconst selectAddDomain = state => state.get('Draft/Add');\n\nconst selectPlateList = createSelector(\n  selectAddDomain,\n  (subState) => subState && subState.plateList,\n)\nconst selectFields = createSelector(\n  selectAddDomain,\n  (subState) => subState && subState.fields,\n)\nconst selectCategoryList = createSelector(\n  selectAddDomain,\n  (subState) => subState && subState.categoryList,\n)\nexport {\n  selectCategoryList,\n  selectPlateList,\n  selectFields,\n}","/**\n * @param str {string} 要计算的字符串，全角为1，半角为0.5\n */\nexport const countNum = (str) => {\n  let count = 0;\n  const re = /[\\u4e00-\\u9fa5]/;\n  const uFF61 = 0xFF61;\n  const uFF9F = 0xFF9F;\n  const uFFE8 = 0xFFE8;\n  const uFFEE = 0xFFEE;\n  if (str) {\n    for (let i = 0, len = str.length; i < len; i += 1) {\n      if (re.test(str[i])) {\n        count += 1;\n      } else {\n        const c = +str.charCodeAt(i);\n        if (c < 256) {\n          count += 0.5;\n        } else if ((uFF61 <= c) && (c <= uFF9F)) {\n          count += 0.5;\n        } else if ((uFFE8 <= c) && (c <= uFFEE)) {\n          count += 0.5;\n        } else {\n          count += 1;\n        }\n      }\n    } }\n  return count;\n}\n/**\n * @param str {string} 要分析的字符串\n */\nexport const isNumber = (str) => {\n  const regPos = /^\\d+(\\.\\d+)?$/; //非负浮点数\n  const regNeg = /^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/; //负浮点数\n  if (regPos.test(str) || regNeg.test(str)) return true;\n  else return false;\n}\n","import React from 'react';\nimport E from 'wangeditor';\nimport { Button, Modal, Form, Input, Upload, message, Spin } from 'antd';\nimport { LeftOutlined, UploadOutlined, PlusOutlined, PictureOutlined } from '@ant-design/icons';\nimport styled from 'styled-components';\n\nconst ToolDef = styled.div`\n  border: 1px solid #ccc;\n  border-bottom: none;\n`;\nconst ToolCus = styled.div`\n  height: 30px;\n  padding: 0 5px;\n  border-right: 1px solid #ccc;\n  border-left: 1px solid #ccc;\n`;\nconst Edit = styled.div`\n  border: 1px solid #ccc;\n  height: 300px;\n  overflow: scroll;\n`;\nconst ToolBtn = styled.div`\n  padding: 5px 10px;\n  cursor: pointer;\n  color: #999;\n  line-height: 14px;\n  font-weight: 500;\n  :hover {\n    color: #000;\n  }\n`;\nclass Editor extends React.PureComponent {\n    constructor(props){\n        super(props);\n        this.wEditor = {};\n        this.state = {\n            editorContent: '',\n            imgUploading: false,\n        };\n    }\n    componentDidMount() {\n        const elem = this.refs.editorElem;\n        const toolElem = this.refs.toolDefElem;\n        this.wEditor = new E(toolElem, elem);\n        // 配置工具栏\n        this.wEditor.customConfig.menus = [\n          'head',  // 标题\n          'bold',  // 粗体\n          'fontSize',  // 字号\n          'fontName',  // 字体\n          'italic',  // 斜体\n          'underline',  // 下划线\n          'strikeThrough',  // 删除线\n          'foreColor',  // 文字颜色\n          'backColor',  // 背景颜色\n          'link',  // 插入链接\n          'list',  // 列表\n          'justify',  // 对齐方式\n          'quote',  // 引用\n          // 'emoticon',  // 表情\n          // 'image',  // 插入图片\n          'table',  // 表格\n          // 'video',  // 插入视频\n          'code',  // 插入代码\n          'undo',  // 撤销\n          'redo'  // 重复\n        ];\n        // 使用 onchange 函数监听内容的变化，并实时更新到 state 中\n        this.wEditor.customConfig.onchange = html => {\n            this.setState({\n              editorContent: html\n            })\n            if (this.props.onChange) this.props.onChange(html);\n        }\n        this.wEditor.create()\n        this.wEditor.txt.html(this.props.defaultValue || '');\n    }\n    render() {\n      const _this = this;\n      const props = {\n        name: 'file',\n        action: window.location.hostname === '127.0.0.1' ? 'http://127.0.0.1:3000/user/fileUpload' : 'http://62.234.73.102:3000/user/fileUpload',\n        showUploadList: false,\n        onChange(info) {\n          _this.setState({\n            imgUploading: true\n          });\n          if (info.file.status === 'done') {\n            message.success(`${info.file.name} 上传成功`);\n            _this.setState({\n              imgUploading: false\n            });\n            _this.wEditor.txt.append(`<p><img src='${info.file.response.location}' /></p>`)\n          } else if (info.file.status === 'error') {\n            message.error(`${info.file.name} 上传失败`);\n            _this.setState({\n              imgUploading: false\n            });\n          }\n        },\n      };\n      return (\n        <div>\n          <ToolDef id=\"toolDef\" ref=\"toolDefElem\"></ToolDef>\n          <ToolCus id=\"toolCus\">\n          <Upload {...props}>\n            <ToolBtn>\n              {this.state.imgUploading ? <Spin size=\"small\" /> : <PictureOutlined />}\n            </ToolBtn>\n          </Upload>\n          </ToolCus>\n          <Edit ref=\"editorElem\"></Edit>\n        </div>\n      );\n    }\n}\n\nexport default Editor;","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { Table, Button, Modal, Form, Input, Tabs, Row, Col, Radio, TreeSelect, Select, Upload, message } from 'antd';\nimport { LeftOutlined, UploadOutlined, PlusOutlined } from '@ant-design/icons';\nimport { Title, Wrapper, RightSide, LeftSide } from '@/components/Style';\nimport styled from 'styled-components';\nimport * as actions from './actions';\nimport { selectFields, selectCategoryList, selectPlateList } from './selectors';\nimport { countNum } from '@/utils/tools';\nimport WangEditor from '@/components/Editor';\nconst { TabPane } = Tabs;\nconst { TextArea } = Input;\nconst { Option } = Select;\nconst ButtonCon = styled.div`\n  button{\n    margin-right: 15px;\n  }\n`;\n// 递归树形结构\nconst transCategoryData = (data) => {\n  const finalData = [];\n  const findChild = (arr) => {\n    const finalChild = arr;\n    arr.forEach((pNode, index) => {\n      const tChild = [];\n      data.forEach((cNode) => {\n        if (pNode.cid === cNode.pid) {\n          cNode.title = cNode.name;\n          cNode.value = cNode.cid;\n          cNode.key = cNode.cid;\n          tChild.push(cNode);\n        }\n      })\n      if (tChild.length) {\n        findChild(tChild);\n        finalChild[index].children = tChild;\n      }\n    })\n    return finalChild\n  }\n  data.forEach((item) => {\n    if (item.pid === 0) {\n      item.title = item.name;\n      item.value = item.cid;\n      item.key = item.cid;\n      finalData.push(item);\n    }\n  })\n  return findChild(finalData);\n}\nclass Add extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      formRef: React.createRef(),\n      publishing: false,\n    };\n  }\n  componentWillMount() {\n    this.props.loadCategory();\n  }\n  handleLoadPlate = (value) => {\n    const params = { cid: value };\n    this.state.formRef.current.setFieldsValue({ plate: []})\n    this.props.loadPlate(params);\n  }\n  handleFilesChange = (values) => {\n    if (this.state.timer) clearTimeout(this.state.timer);\n    const tTimer = setTimeout(() => {\n      this.props.fieldsChange(values);\n      this.setState({\n        timer: '',\n      })\n    }, 200)\n    this.setState({\n      timer: tTimer\n    })\n  }\n  handlePublish = () => {\n    const { publishing } = this.state;\n    if (!publishing) {\n      const _this = this;\n      this.setState({\n        publishing: true\n      }, () => {\n        setTimeout(() => {\n          this.setState({\n            publishing: false,\n          })\n        }, 1000);\n        _this.state.formRef.current.validateFields().then(values => {\n          const params = {};\n          Object.keys(values).forEach((key) => {\n            if (key === 'plate') params.plate = values.plate.join(',');\n            if (key === 'cover') params.cover = values.cover.join('|');\n            else params[key] = values[key];\n          })\n          params.type = '1';\n          this.props.publishDraft(params);\n        })\n      })\n    } else return;\n  }\n  getImageList = (e) => {\n    const imageList = [];\n    if (!e.fileList || !Array.isArray(e.fileList)) return imageList;\n    e && e.fileList.forEach((file) => {\n      const tUrl = file.response && file.response.code * 1 === 0 && file.response.location;\n      if (tUrl) imageList.push(tUrl);\n    });\n    return imageList;\n  }\n  render() {\n    const { categoryList, plateList, fields } = this.props;\n    const { formRef } = this.state;\n    const layout = {\n      labelCol: { span: 2 },\n      wrapperCol: { span: 22 },\n    };\n    const layoutRight = {\n      labelCol: { span: 6 },\n      wrapperCol: { span: 18 },\n    };\n    const operations = <ButtonCon>\n      <Button> 保存草稿 </Button>\n      <Button type=\"primary\" onClick={() => this.handlePublish()}> 发布 </Button>\n      </ButtonCon>;\n    console.log(window.location.hostname);\n    const uploadProps = {\n      name: 'file',\n      action: window.location.hostname === '127.0.0.1' ? 'http://127.0.0.1:3000/user/fileUpload' : 'http://62.234.73.102:3000/user/fileUpload',\n      className: 'avatar-uploader',\n      showUploadList: true,\n      listType: 'picture-card',\n      // headers: {\n      //   authorization: 'authorization-text',\n      // },\n      onChange(info) {\n        if (info.file.status !== 'uploading') {\n          // console.log(info.file, info.fileList);\n        }\n        if (info.file.status === 'done') {\n          message.success(`${info.file.name} 上传成功`);\n          return info.fileList;\n        } else if (info.file.status === 'error') {\n          message.error(`${info.file.name} 上传失败`);\n        }\n      },\n    }\n    return (\n      <div>\n        <Title><Button style={{ float: 'left' }} icon={<LeftOutlined />} onClick={() => this.props.history.goBack()} /><h2>添加稿件</h2></Title>\n        <Wrapper style={{ minWidth: '950px' }}>\n          <Tabs defaultActiveKey=\"1\" type=\"card\" tabBarExtraContent={operations}>\n            <TabPane tab=\"文章\" key=\"1\">\n              <Form\n                ref={formRef}\n                onFieldsChange={(_, all) => this.handleFilesChange(all)}\n                fields={(fields && fields.length) ? fields : []}\n                initialValues={[]}\n              >\n                <RightSide>\n                  <Form.Item\n                    {...layoutRight}\n                    label=\"类目\"\n                    name=\"cid\"\n                    required\n                  >\n                    <TreeSelect\n                      dropdownStyle={{ maxHeight: 400, overflow: 'auto' }}\n                      treeData={transCategoryData(categoryList)}\n                      placeholder=\"请选择类目\"\n                      onChange={this.handleLoadPlate}\n                      treeDefaultExpandAll\n                    />\n                  </Form.Item>\n                  {plateList && !!plateList.length && (\n                    <Form.Item\n                      {...layoutRight}\n                      label=\"板块\"\n                      name=\"plate\"\n                    >\n                      <Select\n                        mode=\"tags\"\n                        placeholder=\"请选择板块\"\n                        defaultValue={[]}\n                      >\n                        {plateList && !!plateList.length && plateList.map((item) => {\n                          return <Option key={item.id}>{item.name}</Option>;\n                        })}\n                      </Select>\n                    </Form.Item>\n                  )}\n                </RightSide>\n                <LeftSide>\n                  <Form.Item\n                    {...layout}\n                    label=\"标题\"\n                    name=\"title\"\n                    required\n                  >\n                    <Input />\n                  </Form.Item>\n                  <Form.Item\n                    {...layout}\n                    label=\"简介\"\n                    name=\"summary\"\n                  >\n                    <TextArea rows={4} />\n                  </Form.Item>\n                  <Form.Item\n                    {...layout}\n                    label=\"正文\"\n                    name=\"content\"\n                  >\n                    <WangEditor\n                      defaultValue={''}\n                    />\n                  </Form.Item>\n                  <Form.Item\n                    {...layout}\n                    label=\"封面\"\n                    name=\"cover\"\n                    getValueFromEvent={this.getImageList}\n                  >\n                    <Upload\n                      {...uploadProps}\n                    >\n                      <div>\n                        <PlusOutlined />\n                        <div className=\"ant-upload-text\">上传</div>\n                      </div>\n                    </Upload>\n                  </Form.Item>\n                  <div>\n                    {/* {covers && !!covers.length && covers.map((url) => (\n                      <div style={{ width: '100px', height: '100px', overflow: 'hidden', float: 'left', }} key={url}><img style={{ width: '100px', height: '100px' }} src={url} alt=\"\"/></div>\n                    ))} */}\n                  </div>\n                </LeftSide>\n              </Form> \n            </TabPane>\n            <TabPane tab=\"图集\" key=\"2\">\n              Content of Tab Pane 2\n            </TabPane>\n            <TabPane tab=\"视频\" key=\"3\">\n              Content of Tab Pane 2\n            </TabPane>\n          </Tabs>\n\n        </Wrapper>\n      </div>\n    )\n  }\n}\nconst mapStateToProps = (state) => {\n  return {\n    fields: selectFields(state),\n    categoryList: selectCategoryList(state),\n    plateList: selectPlateList(state),\n  };\n}\nconst mapActionsToProps = (dispatch) => bindActionCreators({ ...actions }, dispatch);\nexport default connect(mapStateToProps, mapActionsToProps)(Add);\n"],"sourceRoot":""}
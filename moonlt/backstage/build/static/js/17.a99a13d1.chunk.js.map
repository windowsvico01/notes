{"version":3,"sources":["containers/Pages/Draft/List/index.js","containers/Pages/Draft/List/actions.js","containers/Pages/Draft/List/selectors.js"],"names":["List","Select","Option","props","_this","Object","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","this","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__","call","handleLoadPlate","value","params","cid","state","formRef","current","setFieldsValue","plate","loadPlate","handleFilesChange","values","timer","clearTimeout","tTimer","setTimeout","fieldsChange","setState","handlePublish","validateFields","then","keys","forEach","key","join","type","publishDraft","handlePageChange","e","loadDraft","page","loadCategory","_this2","_this$props","draftList","categoryList","plateList","columns1","title","dataIndex","width","render","t","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","moment","format","record","_components_Style__WEBPACK_IMPORTED_MODULE_15__","react_router_dom__WEBPACK_IMPORTED_MODULE_9__","to","concat","style","padding","pagination","total","pageSize","onChange","className","antd__WEBPACK_IMPORTED_MODULE_11__","layout","float","Item","verticalAlign","antd__WEBPACK_IMPORTED_MODULE_12__","placeholder","antd__WEBPACK_IMPORTED_MODULE_13__","onClick","history","push","antd__WEBPACK_IMPORTED_MODULE_14__","columns","dataSource","length","rowKey","Component","connect","selectCategoryList","selectPlateList","selectDraftList","selectPage","selectTotal","dispatch","bindActionCreators","_Users_yangpu_bt_notes_moonlt_backstage_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","actions","__webpack_require__","r","__webpack_exports__","d","LOAD_CATEGORY","LOAD_CATEGORY_SUCCESS","LOAD_PLATE","LOAD_PLATE_SUCCESS","LOAD_DRAFT","LOAD_DRAFT_SUCCESS","loadDraftSuccess","loadCategorySuccess","loadPlateSuccess","data","reselect__WEBPACK_IMPORTED_MODULE_0__","selectAddDomain","get","createSelector","subState"],"mappings":"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","file":"static/js/17.a99a13d1.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { Link } from 'react-router-dom';\nimport { Table, Button, Modal, Form, Input, Tabs, Row, Col, Radio, TreeSelect, Select } from 'antd';\nimport { Title, Wrapper, FormOperate, FloatWrapper } from '@/components/Style';\nimport * as actions from './actions';\nimport { selectCategoryList, selectPlateList, selectDraftList, selectPage, selectTotal } from './selectors';\nimport moment from 'moment';\nconst { Option } = Select;\n// 递归树形结构\nconst transCategoryData = (data) => {\n  const finalData = [];\n  const findChild = (arr) => {\n    const finalChild = arr;\n    arr.forEach((pNode, index) => {\n      const tChild = [];\n      data.forEach((cNode) => {\n        if (pNode.cid === cNode.pid) {\n          cNode.title = cNode.name;\n          cNode.value = cNode.cid;\n          cNode.key = cNode.cid;\n          tChild.push(cNode);\n        }\n      })\n      if (tChild.length) {\n        findChild(tChild);\n        finalChild[index].children = tChild;\n      }\n    })\n    return finalChild\n  }\n  data.forEach((item) => {\n    if (item.pid === 0) {\n      item.title = item.name;\n      item.value = item.cid;\n      item.key = item.cid;\n      finalData.push(item);\n    }\n  })\n  return findChild(finalData);\n}\nclass List extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n  componentWillMount() {\n    this.props.loadCategory();\n    this.props.loadDraft({});\n  }\n  handleLoadPlate = (value) => {\n    const params = { cid: value };\n    this.state.formRef.current.setFieldsValue({ plate: []})\n    this.props.loadPlate(params);\n  }\n  handleFilesChange = (values) => {\n    if (this.state.timer) clearTimeout(this.state.timer);\n    const tTimer = setTimeout(() => {\n      this.props.fieldsChange(values);\n      this.setState({\n        timer: '',\n      })\n    }, 200)\n    this.setState({\n      timer: tTimer\n    })\n  }\n  handlePublish = () => {\n    this.state.formRef.current.validateFields().then(values => {\n      const params = {};\n      Object.keys(values).forEach((key) => {\n        if (key === 'plate') params.plate = values.plate.join(',');\n        else params[key] = values[key];\n      })\n      params.type = '1';\n      this.props.publishDraft(params);\n    })\n  }\n  handlePageChange = (e) => {\n    this.props.loadDraft({ page: e })\n  }\n  render() {\n    const { categoryList, plateList, draftList, page, total } = this.props;\n    const columns1 = [{\n      title: '稿件标题',\n      dataIndex: 'title',\n      key: 'title',\n      width: 300,\n    }, {\n      title: '稿件类型',\n      dataIndex: 'type',\n      key: 'type',\n      render: (t) => {\n        if (t * 1 === 1) return '图文';\n        if (t * 1 === 2) return '图集';\n        if (t * 1 === 3) return '视频';\n      }\n    }, {\n      title: '所属类目',\n      dataIndex: 'category_name',\n      key: 'category_name',\n    }, {\n      title: '所属板块',\n      dataIndex: 'plate_name',\n      key: 'plate_name',\n    }, {\n      title: '作者',\n      dataIndex: 'author_name',\n      key: 'author_name',\n    }, {\n      title: '发布时间',\n      dataIndex: 'create_time',\n      key: 'create_time',\n      render: (t) => <span>{ t && moment(t).format('YYYY-MM-DD HH:mm:ss') }</span>\n    }, {\n      title: '操作',\n      key: 'operate',\n      render: (t, record) => (\n        <FormOperate>\n          <Link to={`/manage/category/detail/${record.cid}`} style={{ padding: '4px 15px' }}>详情</Link>\n        </FormOperate>\n      )\n    }];\n    const pagination = {\n      total,\n      current: page * 1,\n      pageSize: 10,\n      onChange: (e) => this.handlePageChange(e),\n    }\n    return (\n      <div>\n        <Title>\n          <div className=\"borderLeft\"></div>\n          <h2>稿件列表</h2>\n        </Title>\n        <FloatWrapper>\n          <Form layout=\"inline\" style={{ float: 'left' }}>\n            <Form.Item style={{ verticalAlign: '-webkit-baseline-middle' }}>\n              <Input\n                placeholder=\"请输入文章标题\"\n                // value={values}\n                // onChange={this.handleInputChange}\n              />\n            </Form.Item>\n            <Form.Item>\n              <Button className=\"f-r\" type=\"primary\">\n                搜索\n              </Button>\n            </Form.Item>\n          </Form>\n          <Button type=\"primary\" className=\"f-r\" onClick={() => this.props.history.push('/draft/add')}>添加稿件</Button>\n        </FloatWrapper>\n        <Wrapper>\n          <Table columns={columns1} dataSource={draftList && !!draftList.length && draftList} pagination={pagination} rowKey=\"article_id\" />\n        </Wrapper>\n      </div>\n    )\n  }\n}\nconst mapStateToProps = (state) => {\n  return {\n    categoryList: selectCategoryList(state),\n    plateList: selectPlateList(state),\n    draftList: selectDraftList(state),\n    page: selectPage(state),\n    total: selectTotal(state),\n  };\n}\nconst mapActionsToProps = (dispatch) => bindActionCreators({ ...actions }, dispatch);\nexport default connect(mapStateToProps, mapActionsToProps)(List);\n","export const LOAD_CATEGORY = '/Draft/List/LOAD_CATEGORY';\nexport const LOAD_CATEGORY_SUCCESS = '/Draft/List/LOAD_CATEGORY_SUCCESS';\n\nexport const LOAD_PLATE = '/Draft/List/LOAD_PLATE';\nexport const LOAD_PLATE_SUCCESS = '/Draft/List/LOAD_PLATE_SUCCESS';\n\nexport const LOAD_DRAFT = '/Draft/List/LOAD_DRAFT';\nexport const LOAD_DRAFT_SUCCESS = '/Draft/List/LOAD_DRAFT_SUCCESS';\n\nexport function loadDraft(params) {\n  return {\n    type: LOAD_DRAFT,\n    params,\n  };\n}\n\nexport function loadDraftSuccess(data) {\n  return {\n    type: LOAD_DRAFT_SUCCESS,\n    data,\n  };\n}\n\nexport function loadCategory(params) {\n  return {\n    type: LOAD_CATEGORY,\n  };\n}\n\nexport function loadCategorySuccess(data) {\n  return {\n    type: LOAD_CATEGORY_SUCCESS,\n    data,\n  };\n}\n\nexport function loadPlate(params) {\n  return {\n    type: LOAD_PLATE,\n    params,\n  };\n}\n\nexport function loadPlateSuccess(data) {\n  return {\n    type: LOAD_PLATE_SUCCESS,\n    data,\n  };\n}","import { createSelector } from 'reselect';\n// state.get 是异步的\nconst selectAddDomain = state => state.get('Draft/List');\n\nconst selectPlateList = createSelector(\n  selectAddDomain,\n  (subState) => subState && subState.plateList,\n)\nconst selectCategoryList = createSelector(\n  selectAddDomain,\n  (subState) => subState && subState.categoryList,\n)\nconst selectDraftList = createSelector(\n  selectAddDomain,\n  (subState) => subState && subState.draftList,\n)\nconst selectTotal = createSelector(\n  selectAddDomain,\n  (subState) => subState && subState.total,\n)\nconst selectPage = createSelector(\n  selectAddDomain,\n  (subState) => subState && subState.page,\n)\nexport {\n  selectCategoryList,\n  selectPlateList,\n  selectDraftList,\n  selectTotal,\n  selectPage,\n}"],"sourceRoot":""}
{"version":3,"sources":["modules/index.js"],"names":["RenderModules","props","config","modules","pageData","type","template","lt","renderRow","tHtml","forEach","item","$","html","renderModules","moduleWrapper","_this","length","each","index","templateType","attr","modId","params","category","articleId","modData","findMod","init","pModId","finalItem","findChild","data","Array","isArray","item2","window","Modules"],"mappings":"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","sourcesContent":["import modules from './tpl';\nimport row from './tpl/row.art';\nclass RenderModules {\n  constructor(props) {\n    this.config = {\n      modules,\n      pageData:[\n        { type: 'row', template: 'row-full', modules: [\n          [{ type: 'mod', template: 'Header' }]\n        ] },\n        { type: 'row', template: 'row-600-300', modules: [\n          [{ type: 'mod', template: 'Banner' }, { type: 'mod', template: 'InfoFlow' }], \n          [{ type: 'mod', template: 'TextList' }]\n        ] },\n      ],\n      lt: {}, // location信息\n    }\n  }\n  render(props) {\n    this.config.pageData = props.pageData;\n    this.config.lt = props.lt;\n    this.renderRow();\n  }\n  renderRow() {\n    let tHtml = '';\n    this.config.pageData.forEach((item) => {\n      tHtml += row(item);\n    })\n    $('#app').html(tHtml);\n    this.renderModules();\n  }\n  renderModules() {\n    const moduleWrapper = $('.module-wrapper');\n    const _this = this;\n    moduleWrapper.length && moduleWrapper.each((index, item) => {\n      const templateType = $(item).attr('template-type') || 'no-template';\n      const modId = $(item).attr('mod-id');\n      const template = _this.config.modules[templateType] ? new _this.config.modules[templateType]($(item)) : new _this.config.modules['NoTpl']($(item));\n      const params = {\n        category: _this.config.lt.category || '',\n        articleId: _this.config.lt.articleId || '',\n        modData: _this.findMod(modId) || {},\n      };\n      template.init(params);\n    });\n  }\n  findMod(pModId) { // 找到该mod的页面数据\n    const { pageData } = this.config;\n    let finalItem = {};\n    const findChild = (data) => {\n      data.forEach((item) => {\n        if (item.type && item.type === 'row') {\n          findChild(item.modules);\n        } else if (Array.isArray(item)) {\n          item.forEach((item2) => {\n            if (item2.type && item2.type === 'mod') {\n              if (item2.modId === pModId) {\n                finalItem = item2;\n              }\n            } else {\n              findChild(item2);\n            }\n          })\n        }\n      })\n    }\n    findChild(pageData);\n    return finalItem;\n  }\n}\nwindow.Modules = new RenderModules();"],"file":"index.js"}